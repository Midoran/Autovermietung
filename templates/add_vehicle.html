<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fahrzeug hinzufügen</title>
    <div class="container">
    </div>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  </head>
  <body>
  <header class="d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4 border-bottom">
      <div class="col-md-3 mb-2 mb-md-0">
        <a href="/" class="d-inline-flex link-body-emphasis text-decoration-none">
          <svg class="bi" width="40" height="32" role="img" aria-label="Bootstrap"><use xlink:href="#bootstrap"></use></svg>
        </a>
      </div>

      <ul class="nav col-12 col-md-auto mb-2 justify-content-center mb-md-0">
        <li><a href="/index" class="nav-link px-2 link-secondary">Home</a></li>
        <li><a href='/search' class="nav-link px-2">Autosuchen</a></li>
        <li><a href="/list" class="nav-link px-2">Preisliste</a></li>
        <li><a href="/faq" class="nav-link px-2">FAQ</a></li>
        <li><a href="/introduction" class="nav-link px-2">Über uns</a></li>
      </ul>

      <div class="col-md-3 text-end">
        {% if 'user_id' in session %}
        <a href="/registration" class="btn btn-outline-primary me-2 link-secondary">Ausloggen</a>
        <a href="/my_account" class="btn btn-primary">Mein Konto</a>
    {% else %}
        <a href="/login" class="btn btn-outline-primary me-2 link-secondary">Einloggen</a>
        <a href="/registration" class="btn btn-primary">Registrieren</a>
    {% endif %}
      </div>
    </header><form id="vehicleForm">
    <input type="number" name="standort_id" placeholder="Standort-ID" required>
    <input type="text" name="hersteller" placeholder="Hersteller" required>
    <input type="text" name="modell" placeholder="Modell" required>
    <input type="number" name="baujahr" placeholder="Baujahr" required>
    <!-- Checkbox für die Verfügbarkeit. Wenn geprüft, gilt das Fahrzeug als verfügbar. -->
    <input type="checkbox" name="verfuegbarkeit"> Verfügbarkeit<br>
    <input type="text" name="preis" placeholder="Preis" required>
    <input type="number" name="kilometerstand" placeholder="Kilometerstand" required>
    <input type="text" name="kennzeichen" placeholder="Kennzeichen" required>
    <input type="text" name="fahrzeugklasse" placeholder="Fahrzeugklasse" required>
    <button type="submit">Fahrzeug hinzufügen</button>
</form>

<script>
// Fügt dem Formular einen EventListener für das 'submit'-Ereignis hinzu
document.getElementById('vehicleForm').addEventListener('submit', function(e) {
    e.preventDefault(); // Verhindert das Standardverhalten des Formulars, die Seite neu zu laden

    // Erstellt ein Objekt mit den eingegebenen Formulardaten
    var formData = {
        standort_id: document.querySelector('[name="standort_id"]').value,
        hersteller: document.querySelector('[name="hersteller"]').value,
        modell: document.querySelector('[name="modell"]').value,
        baujahr: parseInt(document.querySelector('[name="baujahr"]').value),
        // Überprüft die Checkbox und setzt den Wert entsprechend
        verfuegbarkeit: document.querySelector('[name="verfuegbarkeit"]').checked ? 'J' : 'N',
        preis: document.querySelector('[name="preis"]').value,
        kilometerstand: parseInt(document.querySelector('[name="kilometerstand"]').value),
        kennzeichen: document.querySelector('[name="kennzeichen"]').value,
        fahrzeugklasse: document.querySelector('[name="fahrzeugklasse"]').value,
    };

    // Sendet eine POST-Anfrage an den Server mit den Formulardaten im JSON-Format
    fetch('/add_vehicle', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(formData),
    })
    .then(response => response.json()) // Wandelt die Serverantwort in JSON um
    .then(data => {
        console.log(data); // Zeigt die Antwort in der Konsole an
    })
    .catch(error => console.error('Fehler:', error)); // Fängt und zeigt Fehler im Falle eines Fehlschlags an
});
</script>

